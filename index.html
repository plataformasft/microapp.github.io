<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
  </head>
  <body>
    <section class="hero is-primary is-bold"> <!--<section class="hero is-primary is-bold"> para color verde-->
      
      <div class="hero-body">
        <div class="container">
          <h1 class="title">Survey Microbiología <img src="vitapro_2.png" alt="Logo" style="float: right; width: 180px; height: auto;"></h1>
        </div>
      </div>
    </section>
    <form id="form" class="container m-5 pl-4" method="POST">

           <!--Tipo fecha con formato dd/mm/yyyy-->
           <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
           <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
           <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
           <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.es.min.js"></script>
           
           <style>
            .datepicker-dropdown {
              background-color: #fff;
            }
            .datepicker td, .datepicker th {
              font-size: 12px;
            }
          </style>
           <div class="field">
             <label class="label">Fecha</label>
             <div class="control">
               <input
                 class="input"
                 type="text"
                 placeholder="yyyy-mm-dd"
                 name="fecha_micro"
                 id="date"
                 style="max-width: 210px;"
               />
             </div>
           </div>
           
           <script>
             $(document).ready(function(){
               $('#date').datepicker({
                 format: "yyyy-mm-dd",
                 language: "es",
                 autoclose: true,
                 todayHighlight: true
               });
             });
           </script>
           
         

      <!--Fila 1-->
      <!--Tipo desplegable-->
      <div class="columns">

        <div class="column">
          <div class="field">
            <label class="label">Responsable</label>
            <div class="control">
              <div class="select">
                <select name="responsable_micro" required>
                  <option value="" disabled selected hidden>Selecciona una opción</option>
                  <option value="test">Test</option>
                  <option value="AT Vitapro">AT Vitapro</option>
                  <option value="FT Vitapro">FT Vitapro</option>
                  <option value="Laboratorio externo">Laboratorio externo</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="column">
          <div class="field">
            <label class="label">Cliente</label>
            <div class="control">
              <div class="select">
                <select name="cliente_micro" required>
                  <option value="" disabled selected hidden>Selecciona una opción</option>
                  <option value="ipsp">IPSP</option>
                  <option value="vinicio aguirre">Vinicio Aguirre</option>
                  <option value="marinasol">Marinasol</option>
                  <option value="mandasacorp">mandasacorp</option>
                  <option value="culcamar">culcamar</option>
                  <option value="fonseca">fonseca</option>
                  <option value="langostinera tumbes">langostinera tumbes</option>
                  <option value="icasur">icasur</option>
                  <option value="acuarios marinos">Acuarios Marinos</option>
                  <option value="gms">GMS</option>
                  <option value="promarisco">Promarisco</option>
                  <option value="promasur">Promasur</option>
                  <option value="grlitoral">grlitoral</option>
                  <option value="omarsa">Omarsa</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="column">
          <div class="field">
            <label class="label">Camaronera</label>
            <div class="control">
              <div class="select">
                <select name="camaronera_micro"style="max-width: 210px;"required>
                  <option value="" disabled selected hidden>Selecciona una opción</option>
                  <option value="afrika">Afrika</option>
                  <option value="bajen">Bajen</option>
                  <option value="chanduy">Chanduy</option>
                  <option value="california">California</option>
                  <option value="cachugran">Cachugran</option>
                  <option value="puna">Puna</option>
                  <option value="chongon">Chongon</option>
                  <option value="puerto inca">Puerto Inca</option>
                  <option value="promasur">Promasur</option>
                  <option value="marfrisco">Marfrisco</option>
                  <option value="v.aguirre	israel">V.Aguirre	Israel</option>
                  <option value="acuarios marinos">Acuarios Marinos</option>
                  <option value="culcamar">Culcamar</option>
                  <option value="gms">GMS</option>
                  <option value="grlitoral">GrLitoral</option>
                  <option value="grrivera	Rivermar">GrRivera	Rivermar</option>
                  <option value="icasur">Icasur</option>
                  
                </select>
              </div>
            </div>
          </div>
        </div>
      



        <div class="column">
          <div class="field">
            <label class="label">Sector</label>
            <div class="control">
              <input
                class="input"
                type="text"
                placeholder="Sector"
                name="sector_micro"
                style="max-width: 210px;"
              />
            </div>
          </div>
        </div>

        <div class="column">
          <div class="field">
            <label class="label">Piscina</label>
            <div class="control">
              <input
                class="input"
                type="text"
                placeholder="Piscina"
                name="piscina_micro"
              />
            </div>
          </div>
        </div>
      </div>
       <!--Fila 1-->

       <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth mt-4">
        <thead>
          <tr>
            <th></th>
            <th colspan="4">Resultados</th>
          </tr>
          <tr>
            <th>Camarón / Réplica</th>
            <th>Colonias Amarillas</th>
            <th>Colonias Verdes</th>
            <th>Diversidad</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>Camarón 01</th>
            <td><input type="number" class="input" name="col_ama1"></td>
            <td><input type="number" class="input" name="col_ver1"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_01">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <th>Camarón 02</th>
            <td><input type="number" class="input" name="col_ama2"></td>
            <td><input type="number" class="input" name="col_ver2"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_02">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 03</th>
            <td><input type="number" class="input" name="col_ama3"></td>
            <td><input type="number" class="input" name="col_ver3"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_03">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 04</th>
            <td><input type="number" class="input" name="col_ama4"></td>
            <td><input type="number" class="input" name="col_ver4"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_04">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 05</th>
            <td><input type="number" class="input" name="col_ama5"></td>
            <td><input type="number" class="input" name="col_ver5"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_05">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 06</th>
            <td><input type="number" class="input" name="col_ama6"></td>
            <td><input type="number" class="input" name="col_ver6"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_06">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 07</th>
            <td><input type="number" class="input" name="col_ama7"></td>
            <td><input type="number" class="input" name="col_ver7"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_07">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 08</th>
            <td><input type="number" class="input" name="col_ama8"></td>
            <td><input type="number" class="input" name="col_ver8"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_08">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 09</th>
            <td><input type="number" class="input" name="col_ama9"></td>
            <td><input type="number" class="input" name="col_ver9"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_09">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <th>Camarón 10</th>
            <td><input type="number" class="input" name="col_ama10"></td>
            <td><input type="number" class="input" name="col_ver10"></td>
            <td>        
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="diversidad_10">
                    <option value="" disabled selected hidden>Selecciona una opción</option>
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

    

      <hr style="margin-top: 20px; margin-bottom: 20px;">
      <p class="subtitle is-4 has-text-weight-bold has-text-blue" style="border-top: 1px solid #000; padding-top: 8px;"></p>
      
      <div class="field">
        <label class="label">Confiabilidad de la información</label>
        <div class="control">
          <label class="checkbox">
            <input type="checkbox" name="Agree To Terms" value="yes" required/> Confirmo la confiabilidad y veracidad de la información proporcionada a través de este formulario
          </label>
        </div>
      </div>

      <div class="field">
        <label class="label">Información adicional</label>
        <div class="control">
          <textarea
            class="textarea"
            placeholder="Comentario"
            name="comentario_micro"
          ></textarea>
        </div>
      </div>
      
      <!--adjuntando pdf-->

     

      <div class="field is-grouped">
        <div class="control">
          <button class="button is-primary" type="submit" id="submit-button">
            Guardar
          </button>
        </div>
        <div class="control">
          <button class="button is-danger">Cancelar</button>
        </div>
      </div>
    </form>
    <div
      id="message"
      style="
        display: none;
        margin: 20px;
        font-weight: bold;
        color: rgb(7, 17, 111);
        padding: 8px;
        background-color: rgb(83, 241, 31);
        border-radius: 4px;
        border-color: rgb(11, 61, 132);
      "
    ></div>

    <script>
      document.getElementById("form").addEventListener("submit", function (e) {
        e.preventDefault(); // Prevent the default form submission
        document.getElementById("message").textContent = "Submitting..";
        document.getElementById("message").style.display = "block";
        document.getElementById("submit-button").disabled = true;

        // Collect the form data
        var formData = new FormData(this);
        var keyValuePairs = [];
        for (var pair of formData.entries()) {
          keyValuePairs.push(pair[0] + "=" + pair[1]);
        }

        var formDataString = keyValuePairs.join("&");

        // Send a POST request to your Google Apps Script
        fetch(
             "https://script.google.com/macros/s/AKfycbxjWj-4y9HQ1RAebKaGiKL3EN-xWL81pNLl8Gis46h8a1FA-9CbOFLxF2TZWOFnswzL/exec",
           //"https://script.google.com/macros/s/AKfycbziICwhCQMLOR_68pU0YeLb75vLWan64poPfVuJI0WTrYw6gUn2LCAQZecLwlu-HzqP/exec",
          //https://script.google.com/macros/s/AKfycbziICwhCQMLOR_68pU0YeLb75vLWan64poPfVuJI0WTrYw6gUn2LCAQZecLwlu-HzqP/exec
          //https://script.google.com/macros/s/AKfycbziICwhCQMLOR_68pU0YeLb75vLWan64poPfVuJI0WTrYw6gUn2LCAQZecLwlu-HzqP/exec
          {
            redirect: "follow",
            method: "POST",
            body: formDataString,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )
          .then(function (response) {
            // Check if the request was successful
            if (response) {
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to submit the form.");
            }
          })
          .then(function (data) {
            // Display a success message
            document.getElementById("message").textContent =
              "Data submitted successfully!";
            document.getElementById("message").style.display = "block";
            document.getElementById("message").style.backgroundColor = "green";
            document.getElementById("message").style.color = "beige";
            document.getElementById("submit-button").disabled = false;
            document.getElementById("form").reset();

            setTimeout(function () {
              document.getElementById("message").textContent = "";
              document.getElementById("message").style.display = "none";
            }, 2600);
          })
          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while submitting the form.";
            document.getElementById("message").style.display = "block";
          });
      });
    </script>
  </body>
</html>
